{"ast":null,"code":"import _createForOfIteratorHelper from \"/home/bd2-system/Desktop/esi/website-vuejs/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";\nimport _objectSpread from \"/home/bd2-system/Desktop/esi/website-vuejs/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport _regeneratorRuntime from \"/home/bd2-system/Desktop/esi/website-vuejs/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"/home/bd2-system/Desktop/esi/website-vuejs/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/es.array.includes.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.string.includes.js\";\nimport \"core-js/modules/es.string.iterator.js\";\nimport \"core-js/modules/es.string.trim.js\";\nimport \"core-js/modules/web.dom-collections.iterator.js\";\nimport { mapState, mapActions, mapMutations } from 'vuex';\nexport default {\n  name: 'pergunta-form',\n  mounted: function mounted() {\n    var _this = this;\n    return _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n      return _regeneratorRuntime().wrap(function _callee$(_context) {\n        while (1) switch (_context.prev = _context.next) {\n          case 0:\n            _context.next = 2;\n            return Promise.all([_this.getOrgaos(), _this.getPointInfo({\n              params: {\n                code: _this.$route.params.code\n              }\n            })]);\n          case 2:\n            // Initialize orgao var based on orgao in data\n            if (!_this.orgao && _this.bestFitOrgao) _this.orgao = _this.bestFitOrgao;\n          case 3:\n          case \"end\":\n            return _context.stop();\n        }\n      }, _callee);\n    }))();\n  },\n  data: function data() {\n    return {\n      text: '',\n      maxPedidoLength: 5000,\n      orgao: null\n    };\n  },\n  computed: _objectSpread({\n    remainingChars: function remainingChars() {\n      return this.maxPedidoLength - this.text.length;\n    },\n    bestFitOrgao: function bestFitOrgao() {\n      // If has a orgaos list\n      if (this.orgaos) {\n        // Tries to find the correct orgao for this despesa\n        if (this.pointInfo) {\n          var _iterator = _createForOfIteratorHelper(this.orgaos),\n            _step;\n          try {\n            for (_iterator.s(); !(_step = _iterator.n()).done;) {\n              var orgao = _step.value;\n              if (orgao.key.includes(this.pointInfo.ds_orgao.trim())) {\n                return orgao.key;\n              }\n            }\n          } catch (err) {\n            _iterator.e(err);\n          } finally {\n            _iterator.f();\n          }\n        }\n      }\n      return null;\n    },\n    inicioPergunta: function inicioPergunta() {\n      return \"Referente ao gasto p\\xFAblico \\\"\".concat(this.pointInfo.ds_projeto_atividade, \"\\\", de \").concat(this.pointInfo.cd_anoexecucao, \", cujo \\xF3rg\\xE3o respons\\xE1vel \\xE9 \\\"\").concat(this.pointInfo.ds_orgao, \"\\\", solicito informa\\xE7\\xF5es:\");\n    }\n  }, mapState({\n    pointInfo: function pointInfo(state) {\n      return state.money.pointInfo;\n    },\n    pending: function pending(state) {\n      return state.esic.pending;\n    },\n    orgaos: function orgaos(state) {\n      return state.esic.orgaos;\n    }\n  })),\n  methods: _objectSpread(_objectSpread({\n    send: function send() {\n      var _this2 = this;\n      return _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n        return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n          while (1) switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return _this2.sendPergunta({\n                keywords: [_this2.$route.params.code],\n                orgao: _this2.orgao,\n                text: _this2.inicioPergunta + ' ' + _this2.text\n              });\n            case 2:\n              _this2.closeModal();\n            case 3:\n            case \"end\":\n              return _context2.stop();\n          }\n        }, _callee2);\n      }))();\n    }\n  }, mapActions(['getPointInfo', 'sendPergunta', 'getOrgaos'])), mapMutations(['closeModal']))\n};","map":{"version":3,"names":["mapState","mapActions","mapMutations","name","mounted","_this","_asyncToGenerator","_regeneratorRuntime","mark","_callee","wrap","_callee$","_context","prev","next","Promise","all","getOrgaos","getPointInfo","params","code","$route","orgao","bestFitOrgao","stop","data","text","maxPedidoLength","computed","_objectSpread","remainingChars","length","orgaos","pointInfo","_iterator","_createForOfIteratorHelper","_step","s","n","done","value","key","includes","ds_orgao","trim","err","e","f","inicioPergunta","concat","ds_projeto_atividade","cd_anoexecucao","state","money","pending","esic","methods","send","_this2","_callee2","_callee2$","_context2","sendPergunta","keywords","closeModal"],"sources":["src/components/perguntas/PerguntaForm.vue"],"sourcesContent":["<template>\n  <div class=\"overflow-scroll\">\n    <div class=\"modal-body p-6 pb-4 lg:px-8 sm:pb-6 xl:pb-8\">\n        <h2 class=\"text-xl font-semibold text-neutral-base\">O que deseja perguntar?</h2>\n\n        <p class=\"text-base text-neutral-base my-4\">Aqui você tem como enviar sua dúvida a respeito do gasto. Lembre-se que tanto sua pergunta como a resposta que vai receber do órgão público responsável serão compartilhadas aqui nesse site para todas as pessoas que estiverem interessadas. Para aumentar as chances de receber uma resposta satisfatória, elabore sua pergunta levando em conta algumas dicas, veja <a class=\"underline text-secondary-light\" href=\"http://cafehacker.prefeitura.sp.gov.br/wp-content/uploads/2014/09/cartilha_acessoainfosp.pdf\" target=\"_blank\">aqui</a> algumas delas.\n        </p>\n\n        <div v-if=\"!bestFitOrgao\" id=\"alert-4\" class=\"flex p-4 mb-4 bg-yellow-100 rounded-lg\" role=\"alert\">\n          <svg class=\"flex-shrink-0 w-5 h-5 text-yellow-700\" fill=\"currentColor\" viewBox=\"0 0 20 20\" xmlns=\"http://www.w3.org/2000/svg\"><path fill-rule=\"evenodd\" d=\"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z\" clip-rule=\"evenodd\"></path></svg>\n          <div class=\"ml-3 text-sm font-medium text-yellow-700\">\n            <p>Ops... Parece que não conseguimos achar na lista do E-SIC o órgão responsável por essa despesa. Por favor, escolha um na lista abaixo.</p>\n          </div>\n          <button type=\"button\" class=\"ml-auto -mx-1.5 -my-1.5 bg-yellow-100 text-yellow-500 rounded-lg focus:ring-2 focus:ring-yellow-400 p-1.5 hover:bg-yellow-200 inline-flex h-8 w-8\" data-dismiss-target=\"#alert-4\" aria-label=\"Close\">\n            <span class=\"sr-only\">Fechar</span>\n            <svg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\" xmlns=\"http://www.w3.org/2000/svg\"><path fill-rule=\"evenodd\" d=\"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z\" clip-rule=\"evenodd\"></path></svg>\n          </button>\n        </div>\n\n        <styled-select :options=\"orgaos\" v-model=\"orgao\"/>\n\n        <h3 class=\"text-lg font-normal mt-4 text-neutral-base\">Exemplo de pergunta</h3>\n        <p class=\"text-base text-neutral-base my-4\">{{ inicioPergunta }}</p>\n\n        <form class=\"form\">\n            <div class=\"form-group\">\n              <label class=\"sr-only\" for=\"new-pergunta-textarea\">\n                  {{ $t('Question') }}\n              </label>\n              <textarea id=\"new-pergunta-textarea\"\n                class=\"form-control bg-white border border-gray-300 text-neutral-base text-sm rounded-lg focus:ring-primary-dark focus:border-primary-dark block w-full p-2.5\" \n                :maxlength=\"maxPedidoLength\"\n                v-model=\"text\"\n                rows=\"5\"\n              />\n              <p class=\"text-gray-400 text-xs mt-2\">{{ $t('Remaining characters') }}: {{ remainingChars }}</p>\n            </div>\n             <p class=\"text-base text-neutral-base my-4\">Ao enviar o pedido, você deve estar de acordo com os <router-link class=\"underline text-secondary-base\" to=\"/termos-de-uso\" target=\"_blank\">termos de uso</router-link>.</p>\n            <button-spinner type=\"submit\"\n              @click.prevent.native=\"send\"\n              :condition=\"pending.sendingPergunta\"\n              :disabled=\"!text.length\"\n              class=\"w-full mt-5 text-white cursor-pointer bg-secondary-light hover:bg-secondary-base focus:ring-4 focus:outline-none font-medium rounded-lg text-sm px-5 py-2.5 text-center\"\n              >\n              {{ $t(\"Send\") }}\n            </button-spinner>\n        </form>\n\n       \n    </div>\n  </div>\n    \n</template>\n\n<script>\nimport { mapState, mapActions, mapMutations } from 'vuex'\nexport default {\n  name: 'pergunta-form',\n  async mounted () {\n    await Promise.all([this.getOrgaos(), this.getPointInfo({ params: { code: this.$route.params.code } })])\n    // Initialize orgao var based on orgao in data\n    if (!this.orgao && this.bestFitOrgao) this.orgao = this.bestFitOrgao\n  },\n  data () {\n    return {\n      text: '',\n      maxPedidoLength: 5000,\n      orgao: null\n    }\n  },\n  computed: {\n    remainingChars () {\n      return this.maxPedidoLength - this.text.length\n    },\n    bestFitOrgao () {\n      // If has a orgaos list\n      if (this.orgaos) {\n        // Tries to find the correct orgao for this despesa\n        if (this.pointInfo) {\n          for (let orgao of this.orgaos) {\n            if (orgao.key.includes(this.pointInfo.ds_orgao.trim())) {\n              return orgao.key\n            }\n          }\n        }\n      }\n      return null\n    },\n    inicioPergunta () {\n      return `Referente ao gasto público \"${this.pointInfo.ds_projeto_atividade}\", de ${this.pointInfo.cd_anoexecucao}, cujo órgão responsável é \"${this.pointInfo.ds_orgao}\", solicito informações:`\n    },\n    ...mapState({\n      pointInfo: state => state.money.pointInfo,\n      pending: state => state.esic.pending,\n      orgaos: state => state.esic.orgaos\n    })\n  },\n  methods: {\n    async send () {\n      await this.sendPergunta({\n        keywords: [this.$route.params.code],\n        orgao: this.orgao,\n        text: this.inicioPergunta + ' ' + this.text\n      })\n      this.closeModal()\n    },\n    ...mapActions([\n      'getPointInfo',\n      'sendPergunta',\n      'getOrgaos'\n    ]),\n    ...mapMutations(['closeModal'])\n  }\n}\n</script>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}